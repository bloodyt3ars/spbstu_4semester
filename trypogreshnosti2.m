clear; clc;

analytical_solution = @(t) ((15*exp(-t*(16699/(8100*(2185507/729000 - (1095697^(1/2)*4860000^(1/2))/4860000)^(1/3)) + (2185507/729000 - (1095697^(1/2)*4860000^(1/2))/4860000)^(1/3) + 133/90))*(349045200000*(2185507/729000 - (1095697^(1/2)*4860000^(1/2))/4860000)^(5/3) - 31430107800*(2185507/729000 - (1095697^(1/2)*4860000^(1/2))/4860000)^(1/3) - 1054909875600*(2185507/729000 - (1095697^(1/2)*4860000^(1/2))/4860000)^(2/3) - 2364*1095697^(1/2)*4860000^(1/2) + 53067*1095697^(1/2)*4860000^(1/2)*(2185507/729000 - (1095697^(1/2)*4860000^(1/2))/4860000)^(1/3) + 35910*1095697^(1/2)*4860000^(1/2)*(2185507/729000 - (1095697^(1/2)*4860000^(1/2))/4860000)^(2/3) + 34443590320))/((8100*(2185507/729000 - (1095697^(1/2)*4860000^(1/2))/4860000)^(2/3) + 16699)*(135261900*(2185507/729000 - (1095697^(1/2)*4860000^(1/2))/4860000)^(2/3) + 65610000*(2185507/729000 - (1095697^(1/2)*4860000^(1/2))/4860000)^(4/3) + 278856601)) - (exp(t*(16699/(16200*(2185507/729000 - (1095697^(1/2)*4860000^(1/2))/4860000)^(1/3)) + (2185507/729000 - (1095697^(1/2)*4860000^(1/2))/4860000)^(1/3)/2 - 133/90))*cos((3^(1/2)*t*(16699/(8100*(2185507/729000 - (1095697^(1/2)*4860000^(1/2))/4860000)^(1/3)) - (2185507/729000 - (1095697^(1/2)*4860000^(1/2))/4860000)^(1/3)))/2)*(11970*(2185507/729000 - (1095697^(1/2)*4860000^(1/2))/4860000)^(1/3) + 8100*(2185507/729000 - (1095697^(1/2)*4860000^(1/2))/4860000)^(2/3) + 16699)*(399*1095697^(1/2)*4860000^(1/2) - 3997740600*(2185507/729000 - (1095697^(1/2)*4860000^(1/2))/4860000)^(1/3) + 10820952000*(2185507/729000 - (1095697^(1/2)*4860000^(1/2))/4860000)^(2/3) + 2624400000*(2185507/729000 - (1095697^(1/2)*4860000^(1/2))/4860000)^(4/3) + 5340815420))/(6*(8100*(2185507/729000 - (1095697^(1/2)*4860000^(1/2))/4860000)^(2/3) + 16699)*(135261900*(2185507/729000 - (1095697^(1/2)*4860000^(1/2))/4860000)^(2/3) + 65610000*(2185507/729000 - (1095697^(1/2)*4860000^(1/2))/4860000)^(4/3) + 278856601)) - (3^(1/2)*exp(t*(16699/(16200*(2185507/729000 - (1095697^(1/2)*4860000^(1/2))/4860000)^(1/3)) + (2185507/729000 - (1095697^(1/2)*4860000^(1/2))/4860000)^(1/3)/2 - 133/90))*sin((3^(1/2)*t*(16699/(8100*(2185507/729000 - (1095697^(1/2)*4860000^(1/2))/4860000)^(1/3)) - (2185507/729000 - (1095697^(1/2)*4860000^(1/2))/4860000)^(1/3)))/2)*(11970*(2185507/729000 - (1095697^(1/2)*4860000^(1/2))/4860000)^(1/3) + 8100*(2185507/729000 - (1095697^(1/2)*4860000^(1/2))/4860000)^(2/3) + 16699)*(399*1095697^(1/2)*4860000^(1/2) - 3997740600*(2185507/729000 - (1095697^(1/2)*4860000^(1/2))/4860000)^(1/3) + 5410476000*(2185507/729000 - (1095697^(1/2)*4860000^(1/2))/4860000)^(2/3) - 5813448620))/(6*(8100*(2185507/729000 - (1095697^(1/2)*4860000^(1/2))/4860000)^(2/3) - 16699)*(135261900*(2185507/729000 - (1095697^(1/2)*4860000^(1/2))/4860000)^(2/3) + 65610000*(2185507/729000 - (1095697^(1/2)*4860000^(1/2))/4860000)^(4/3) + 278856601)) + 10);
% analytical_solution = @(t) (10.0 - 9.99*exp(-0.03991*t)*cos(0.1325*t) - 3.348*exp(-0.03991*t)*sin(0.1325*t) - 0.01028*exp(-4.354*t));

a0=1;
a1=4.4;
a2=53.2;
a3=12;
u=10;
X0 = [0; 0; 0];

z1 = (-a0/a3);
z2 = (-a1/a3);
z3 = (-a2/a3);
z4 = (1/a3);

A=[0 1 0; 0 0 1; z1 z2 z3];
B=[0;0;z4];
E = eye(3);
h=0.2;
t=0;
X = A*X0+B*u;
Y_kute_solution=[];
X_kute_solution=[];

Y_analytical_solution=[];
X_analytical_solution=[];
i=1;
while t<=160
    l1=A*X0+B*u;
    l2=A*(X0+l1*h/2)+B*u;
    l3=A*(X0+l2*h/2)+B*u;
    l4=A*(X0+l3*h)+B*u;
    X_next = X0 + h*(l1+2*l2+2*l3+l4)/6;
    X0=X_next;
    X_kute_solution(i,:)=X_next(1);
    Y_kute_solution(i,:)=t;
    
    Y_analytical_solution(i,:)=t;
    X_analytical_solution(i,:)=analytical_solution(t);
    
    X=X_next;
    t=t+h;
    i=i+1;
end
X_kute_solution
difference_solution=abs(X_analytical_solution-X_kute_solution);
% plot(Y_kute_solution,X_kute_solution)
% plot(Y_analytical_solution, X_analytical_solution)
% plot(Y_analytical_solution, difference_solution)
